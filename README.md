# Whirled Session Exploit
An exploit that receives the session cookie of any Whirled clone.

A Whirled clone is a forked project from the Three Rings msoy project, which is found here: https://github.com/greyhavens/msoy

### Flash File
There's a flash file that contains the flash file you can export as an SWF to receive session information on users that see the client.

### PHP and MySQL File
There's a PHP file that stores the session into the database.  
There's a SQL file that is the template to the database to store the session information.

# Configurations
1. You must change the URLRequest and Security Policy URL inside of the Flash file to the proper URL of the server you're running.  
2. Also, the server you run must also contain a crossdomain.xml file that the Security Policy loads, which a template crossdomain.xml is provided here.  
3. You also need to change the database information inside of the php file to your database credentials.

# How I Discovered The Exploit
Originally, my session exploit would read into the flash vars and that was great and working. Until, a developer on Synced Online patched that system and decided to use JavaScript cookies instead. I tried to use ExternalInterface in ActionScript to access the JavaScript cookies, but it didn't work on my avatar.

I later discovered that to use ExternalInterface I had to not create an avatar with the Whirled classpaths. Then, I tried that solution and it worked successfully.

# How To Prevent This Exploit
Flash has a security policy where if you load a SWF file, you can determine whether or not it can execute JavaScript through the ```allowScriptAccess``` policy, so just set that policy to the ```sameDomain``` and set the media folder of your msoy (Whirled clone) to a different domain. Therefore, anything uploaded onto your Whirled clone will now be on a different domain and cannot execute JavaScript.
